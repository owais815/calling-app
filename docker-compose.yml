services:
    mirotalksfu:
        build:
            context: .
            dockerfile: Dockerfile
        container_name: mirotalksfu
        hostname: mirotalksfu
        restart: unless-stopped
        privileged: true
        environment:
            # Set this to your VPS public IP — required for WebRTC ICE candidates
            - MEDIASOUP_ANNOUNCED_IP=${MEDIASOUP_ANNOUNCED_IP}
            # LMS shared secret — must match backend CALLING_APP_API_SECRET
            - CALLING_APP_API_SECRET=${CALLING_APP_API_SECRET:-lms_calling_secret_2026}
            - PORT=3010
        volumes:
            - ./app/src/config.js:/src/app/src/config.js:ro
        # host network mode: required for mediasoup worker permissions + WebRTC UDP
        network_mode: host
